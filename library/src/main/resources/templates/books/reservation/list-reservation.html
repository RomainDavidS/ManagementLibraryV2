<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
      layout:decorate="model/layout">

<head>
    <title>Liste des réservations</title>
</head>
<body>
<main role="main" class="container" layout:fragment="content" th:with="fn = ${@reservationFunction}" >

        <div class="alert alert-primary text-center" role="alert" th:if="${reservationBeanList.size() == 0}">
            Aucune réservation à afficher
        </div>
        <div  class="card my-1" th:if="${ reservationBeanList.size() > 0}">
            <div class="card-body" >

                <div class="container my-1" >
                    <div class="col-md-12">
                        <table class="table table-striped table-responsive-md"
                               id="tableReservation"
                               data-toggle="table"
                               data-search="true"
                               data-show-search-clear-button="true"
                               data-pagination="true">
                            <thead>
                            <tr>
                                <th scope="col" data-field="reservationPosition" data-sortable="true">Position</th>
                                <th scope="col" data-field="reservationUsage" data-sortable="true">Nom de l'usager</th>
                                <th scope="col" data-field="reservationLivre" data-sortable="true">Nom du livre</th>
                                <th scope="col" data-field="reservationDisponible" data-sortable="true">Disponible</th>
                                <th scope="col" data-field="reservationDate" data-sortable="true">Réservation</th>
                                <th scope="col" data-field="reservationNotification" data-sortable="true">Notification</th>
                                <th scope="col" data-field="secteurEtat" data-sortable="true">Etat</th>
                                <th scope="col" data-field="secteurAction" data-sortable="true">Action</th>

                            </tr>
                            </thead>
                            <!-- pour mémo : td th:text="${#dates.format(c.dateUpdate, 'dd MMM yyyy à HH:mm')}" th:width="190">&nbsp;</td-->
                            <tbody>

                            <tr th:each="r : ${reservationBeanList}" >

                                <td>
                                    <span th:text="${fn.positionUser( r ) }"  class="text-muted text-center"></span>
                                    &nbsp;
                                </td>
                                <td th:text="${fn.getUserReservation(r.idUserReservation)}"></td>
                                <td th:text="${r.book.title}"></td>
                                <td class="text-muted text-center">[Date de disponibilite]</td>
                                <td class="text-muted text-center">[Date de réservation]</td>
                                <td class="text-muted text-center" >[Date de Notification]</td>
                                <td th:text="${r.reservationState.name}" class="text-muted text-center"></td>
                                <td>
                                    <a th:href="@{/reservation/update/{id}(id=${r.id})}"class="btn btn-sm btn-outline-danger">
                                        <i class="fas fa-comment mx-2"></i>A annuler</a>
                                    <a th:href="@{/reservation/update/{id}(id=${r.id})}"class="btn btn-sm btn-outline-success">
                                        <i class="fas fa-comment mx-2"></i>Valider l'enprunt</a>
                                </td>

                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    <!-------------------------------  fin de div.row : Description --------------------------->
</main>

</body>
</html>